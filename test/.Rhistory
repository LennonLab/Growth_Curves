brent.mean.l <- ddply(brent, c("Curve"), summarise, mean=mean(L))
brent.mean.l.barplot <- ggplot(brent.mean.l, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
brent.means.l.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(L), sem=sd(L)/sqrt(length(L)))
brent.means.l.sem <- transform(brent.means.l.sem, lower=mean-sem, upper=mean+sem)
brent.mean.l.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.l.sem)  +
labs(x="Treatment", y="Lag Time") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent <- -brent[8 ,]
brent <- read.csv("brent.csv", header = T)
brent <- brent[1:7 ,]
brent <- subset(brent, select = c("Curve", "Rep", "umax", "A", "L"))
brent.mean <- ddply(brent, c("Curve"), summarise, mean=mean(umax))
brent.mean.barplot <- ggplot(brent.mean, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
brent.means.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(umax), sem=sd(umax)/sqrt(length(umax)))
brent.means.sem <- transform(brent.means.sem, lower=mean-sem, upper=mean+sem)
brent.mean.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.sem)  +
labs(x="Treatment", y="Maximum growth rate") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.umax.aov <- anova(lm(umax ~ Treatment, data=brent))
brent.umax.aov
brent.umax.aov <- anova(lm(umax ~ Curve, data=brent))
brent.umax.aov
brent.mean.l <- ddply(brent, c("Curve"), summarise, mean=mean(L))
brent.mean.l.barplot <- ggplot(brent.mean.l, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
brent.means.l.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(L), sem=sd(L)/sqrt(length(L)))
brent.means.l.sem <- transform(brent.means.l.sem, lower=mean-sem, upper=mean+sem)
brent.mean.l.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.l.sem)  +
labs(x="Treatment", y="Lag Time") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.umax.t <- t.test(umax~Curve, data=brent)
brent.umax.t
brent.mean.l <- ddply(brent, c("Curve"), summarise, mean=mean(L))
# Bar graph showing the difference in lag time between treatments for each strain #
brent.mean.l.barplot <- ggplot(brent.mean.l, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
# Standard Errors #
brent.means.l.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(L), sem=sd(L)/sqrt(length(L)))
brent.means.l.sem <- transform(brent.means.l.sem, lower=mean-sem, upper=mean+sem)
# Ploting bargraph with standard errors #
brent.mean.l.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.l.sem)  +
labs(x="Treatment", y="Lag Time") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.mean.l.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.l.sem)  +
labs(x="Treatment", y="Lag Time") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.l.t <- t.test(L~Curve, data=brent)
brent.l.t # umax increased with Rpf treatment
brent.mean.a <- ddply(brent, c("Curve"), summarise, mean=mean(A))
# Bar graph showing the difference in umax between treatments for each strain #
brent.mean.a.barplot <- ggplot(brent.mean.a, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
# Standard Errors #
brent.means.a.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(A), sem=sd(A)/sqrt(length(A)))
brent.means.a.sem <- transform(brent.means.a.sem, lower=mean-sem, upper=mean+sem)
# Ploting bargraph with standard errors #
brent.mean.a.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.a.sem)  +
labs(x="Treatment", y="Biomass Yield (OD600)") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.l.a <- t.test(A~Curve, data=brent)
brent.l.a # Lag time does not seem to be different among treatment but that doesn't make sense
growth.modGomp("../data/Brentgrowthcurve.csv", "csv_test", synergy=F, temp=F, smooth=F)
rm(list=ls())
setwd("C:/Users/Venus/Github/Growth_Curves/test")
# Load Dependencies
source("../bin/modified_Gomp.R")
growth.modGomp("../data/Brentgrowthcurve.csv", "csv_test", synergy=F, temp=F, smooth=F)
growth.modGomp("../data/Brentgrowthcurve.csv", "csv_test", synergy=F, temp=F)
growth.modGomp("../data/Brentgrowthcurve.csv", "csv_test", synergy=F, temp=F)
growth.modGomp("../data/Brentgrowthcurve.csv", "test", skip=31)
rm(list=ls())
getwd()
setwd("~/GitHub/Rpf/growth")
require("png")
rm(list = ls())
# Load Brent's growth curve data #
brent <- read.csv("brent.csv", header = T)
brent <- brent[1:7 ,] # Remove one replicate of Rpf +, werid values
brent <- subset(brent, select = c("Curve", "Rep", "umax", "A", "L"))
brent.mean <- ddply(brent, c("Curve"), summarise, mean=mean(umax))
# Bar graph showing the difference in umax between treatments for each strain #
brent.mean.barplot <- ggplot(brent.mean, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
# Standard Errors #
brent.means.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(umax), sem=sd(umax)/sqrt(length(umax)))
brent.means.sem <- transform(brent.means.sem, lower=mean-sem, upper=mean+sem)
# Ploting bargraph with standard errors #
brent.mean.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.sem)  +
labs(x="Treatment", y="Maximum growth rate") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.umax.t <- t.test(umax~Curve, data=brent)
brent.umax.t # umax increased with Rpf treatment
# Lag time #
# Summarize lag time growth parameters #
brent.mean.l <- ddply(brent, c("Curve"), summarise, mean=mean(L))
# Bar graph showing the difference in lag time between treatments for each strain #
brent.mean.l.barplot <- ggplot(brent.mean.l, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
# Standard Errors #
brent.means.l.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(L), sem=sd(L)/sqrt(length(L)))
brent.means.l.sem <- transform(brent.means.l.sem, lower=mean-sem, upper=mean+sem)
# Ploting bargraph with standard errors #
brent.mean.l.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.l.sem)  +
labs(x="Treatment", y="Lag Time") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.l.t <- t.test(L~Curve, data=brent)
brent.l.t # Lag time does not seem to be different among treatment but that doesn't make sense
# Biomass Yield #
# Summarize Biomass (A) data #
brent.mean.a <- ddply(brent, c("Curve"), summarise, mean=mean(A))
# Bar graph showing the difference in umax between treatments for each strain #
brent.mean.a.barplot <- ggplot(brent.mean.a, aes(x=Curve, y = mean)) +
geom_bar(stat = "identity", width=0.5, position="dodge", color="black", size=1.25, fill="white") +
theme_bw()
# Standard Errors #
brent.means.a.sem <- ddply(brent, c("Curve"), summarise,
mean=mean(A), sem=sd(A)/sqrt(length(A)))
brent.means.a.sem <- transform(brent.means.a.sem, lower=mean-sem, upper=mean+sem)
# Ploting bargraph with standard errors #
brent.mean.a.barplot +
geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9), width=0.15, data=brent.means.a.sem)  +
labs(x="Treatment", y="Biomass Yield (OD600)") +
theme_classic() +
theme(axis.text=element_text(colour="black", size=18),
axis.title=element_text(size=20),
axis.title.y = element_text(colour="black",  margin = margin(0,25,0,0)),
axis.title.x = element_text(colour="black",margin=margin(18,0,0,0)),
panel.border = element_rect(linetype = "solid", colour = "black", size=2, fill=NA))
brent.l.a <- t.test(A~Curve, data=brent)
brent.l.a # Biomass increases with Rpf treatment
rm(list=ls())
getwd()
setwd("~/GitHub/Rpf/growth")
setwd("C:/Users/Venus/Github/Rpf/growth")
require("png")
od.raw <- read.csv("growth.curve.txt", head = TRUE, sep = "\t")
head(od.raw)
od.early <- od.raw[1:29,]
od.late <- od.raw[29:nrow(od.raw),1:5]
sem <- function(x) sqrt(var(x)/length(x))
od.cont <- data.frame(od.early[,1], apply(od.early[, 2:5], 1, mean),
apply(od.early[, 2:5], 1, sem))
colnames(od.cont)[1:3] <- c("hour", "cont.mean", "cont.sem")
od.rpf <- data.frame(od.early[,1], apply(od.early[, 6:9], 1, mean),
apply(od.early[, 6:9], 1, sem))
colnames(od.rpf)[1:3] <- c("hour", "rpf.mean", "rpf.sem")
png(filename="~/GitHub/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
# Add ticks and tick labels
axis(side = 2, lwd.ticks = 2, las = 1, cex.axis = 1.25,
labels = c("0", "1", "2", "3", "4"),
at = c(0, 1, 2, 3, 4))
axis(side = 4, labels = F, lwd.ticks = 2,
at = c(0, 1, 2, 3, 4))
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1, mgp = c(3, 2, 0),
labels = c(0, 100, 200, 300, 400, 500, 600), at = c(0, 100, 200, 300, 400, 500, 600))
axis(side = 3, labels = F, lwd.ticks = 2, las = 1, cex.axis = 1.25,
at = c(0, 100, 200, 300, 400))
mtext('Biomass (OD600)', side = 2, outer = TRUE, cex = 1.5,
line = -2, adj = 0.6)
mtext('Time (h)', side = 1, outer = TRUE, cex = 1.5,
line = -2.5, adj = 0.5)
# Add late ODs from controls
lines(od.late[,1], od.late[,2], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,3], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,4], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,5], lty=2, col="black", lwd = 2)
dev.off()
graphics.off()
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
# Add ticks and tick labels
axis(side = 2, lwd.ticks = 2, las = 1, cex.axis = 1.25,
labels = c("0", "1", "2", "3", "4"),
at = c(0, 1, 2, 3, 4))
axis(side = 4, labels = F, lwd.ticks = 2,
at = c(0, 1, 2, 3, 4))
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1, mgp = c(3, 2, 0),
labels = c(0, 100, 200, 300, 400, 500, 600), at = c(0, 100, 200, 300, 400, 500, 600))
axis(side = 3, labels = F, lwd.ticks = 2, las = 1, cex.axis = 1.25,
at = c(0, 100, 200, 300, 400))
mtext('Biomass (OD600)', side = 2, outer = TRUE, cex = 1.5,
line = -2, adj = 0.6)
mtext('Time (h)', side = 1, outer = TRUE, cex = 1.5,
line = -2.5, adj = 0.5)
# Add late ODs from controls
lines(od.late[,1], od.late[,2], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,3], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,4], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,5], lty=2, col="black", lwd = 2)
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
# Add ticks and tick labels
axis(side = 2, lwd.ticks = 2, las = 1, cex.axis = 1.25,
labels = c("0", "1", "2", "3", "4"),
at = c(0, 1, 2, 3, 4))
axis(side = 4, labels = F, lwd.ticks = 2,
at = c(0, 1, 2, 3, 4))
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1, mgp = c(3, 2, 0),
labels = c(0, 100, 200, 300, 400, 500, 600), at = c(0, 100, 200, 300, 400, 500, 600))
axis(side = 3, labels = F, lwd.ticks = 2, las = 1, cex.axis = 1.25,
at = c(0, 100, 200, 300, 400))
mtext('Biomass (OD600)', side = 2, outer = TRUE, cex = 1.5,
line = -2, adj = 0.6)
mtext('Time (h)', side = 1, outer = TRUE, cex = 1.5,
line = -2.5, adj = 0.5)
# Add late ODs from controls
lines(od.late[,1], od.late[,2], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,3], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,4], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,5], lty=2, col="black", lwd = 2)
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
od.raw <- read.csv("growth.curve.txt", head = TRUE, sep = "\t")
head(od.raw)
od.early <- od.raw[1:29,]
od.late <- od.raw[29:nrow(od.raw),1:5]
sem <- function(x) sqrt(var(x)/length(x))
od.cont <- data.frame(od.early[,1], apply(od.early[, 2:5], 1, mean),
apply(od.early[, 2:5], 1, sem))
colnames(od.cont)[1:3] <- c("hour", "cont.mean", "cont.sem")
od.rpf <- data.frame(od.early[,1], apply(od.early[, 6:9], 1, mean),
apply(od.early[, 6:9], 1, sem))
colnames(od.rpf)[1:3] <- c("hour", "rpf.mean", "rpf.sem")
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
# Add ticks and tick labels
axis(side = 2, lwd.ticks = 2, las = 1, cex.axis = 1.25,
labels = c("0", "1", "2", "3", "4"),
at = c(0, 1, 2, 3, 4))
axis(side = 4, labels = F, lwd.ticks = 2,
at = c(0, 1, 2, 3, 4))
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1, mgp = c(3, 2, 0),
labels = c(0, 100, 200, 300, 400, 500, 600), at = c(0, 100, 200, 300, 400, 500, 600))
axis(side = 3, labels = F, lwd.ticks = 2, las = 1, cex.axis = 1.25,
at = c(0, 100, 200, 300, 400))
mtext('Biomass (OD600)', side = 2, outer = TRUE, cex = 1.5,
line = -2, adj = 0.6)
mtext('Time (h)', side = 1, outer = TRUE, cex = 1.5,
line = -2.5, adj = 0.5)
# Add late ODs from controls
lines(od.late[,1], od.late[,2], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,3], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,4], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,5], lty=2, col="black", lwd = 2)
#dev.off()
#graphics.off()
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
png(filename="C:/Users/Venus/Github/Rpf/growth/growth.curve.png",
width = 1200, height = 700, res = 96*2)
plot.new()
par(mar = c(7, 7, 5, 7))
plot(od.cont[,1], od.cont[,2], xlim = c(0, 625), ylim = c(-0.5, 4), type = "b",
pch = 22, bg = "grey", col = "black", cex = 2, ylab = "", xlab = "",
cex.lab = 1.5, las = 1, lwd = 2, yaxt = "n", xaxt = "n",
panel.first={
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] - od.cont[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.cont[,1], y0 = od.cont[,2], y1 = od.cont[, 2] +
od.cont[, 3], angle = 90,length = 0.05, lwd = 2)
})
box(lwd=2)
# Construct Rpf plot
points(od.rpf[,1], od.rpf[,2], type = "b", pch = 22, bg = "white", col = "black",
cex = 2, cex.lab = 1.5, lwd = 2,
panel.first={
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] - od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
arrows(x0 = od.rpf[,1], y0 = od.rpf[, 2], y1 = od.rpf[, 2] + od.rpf[, 3],
angle = 90, length = 0.05, lwd = 2)
})
# Add ticks and tick labels
axis(side = 2, lwd.ticks = 2, las = 1, cex.axis = 1.25,
labels = c("0", "1", "2", "3", "4"),
at = c(0, 1, 2, 3, 4))
axis(side = 4, labels = F, lwd.ticks = 2,
at = c(0, 1, 2, 3, 4))
axis(side = 1, lwd.ticks = 2, cex.axis = 1.25, las = 1, mgp = c(3, 2, 0),
labels = c(0, 100, 200, 300, 400, 500, 600), at = c(0, 100, 200, 300, 400, 500, 600))
axis(side = 3, labels = F, lwd.ticks = 2, las = 1, cex.axis = 1.25,
at = c(0, 100, 200, 300, 400))
mtext('Biomass (OD600)', side = 2, outer = TRUE, cex = 1.5,
line = -2, adj = 0.6)
mtext('Time (h)', side = 1, outer = TRUE, cex = 1.5,
line = -2.5, adj = 0.5)
# Add late ODs from controls
lines(od.late[,1], od.late[,2], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,3], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,4], lty=2, col="black", lwd = 2)
lines(od.late[,1], od.late[,5], lty=2, col="black", lwd = 2)
#dev.off()
#graphics.off()
rm(list=ls())
setwd("C:/Users/Venus/Github/Growth_Curves/test")
# Load Dependencies
source("../bin/modified_Gomp.R")
growth.modGomp("../data/GrowthCurve_Example.txt", "test", skip=31)
